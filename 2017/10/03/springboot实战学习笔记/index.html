<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>springboot实战学习笔记 | 笔记本</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="安装spring cli略 创建项目 用网页创建:http:&#x2F;&#x2F;start.spring.io&#x2F; 用Intellij创建. 如果是创建了gradle项目,一般需要加上插件:apply plugin: ‘idea’执行:gradle cleanIdea idea才能正常使用.(idea生成的项目默认使用eclipse的插件,多么讽刺)    JPA相关:https:&#x2F;&#x2F;zhuanlan.zhihu.">
<meta property="og:type" content="article">
<meta property="og:title" content="springboot实战学习笔记">
<meta property="og:url" content="http://xiaoyue26.github.io/2017/10/03/springboot%E5%AE%9E%E6%88%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="笔记本">
<meta property="og:description" content="安装spring cli略 创建项目 用网页创建:http:&#x2F;&#x2F;start.spring.io&#x2F; 用Intellij创建. 如果是创建了gradle项目,一般需要加上插件:apply plugin: ‘idea’执行:gradle cleanIdea idea才能正常使用.(idea生成的项目默认使用eclipse的插件,多么讽刺)    JPA相关:https:&#x2F;&#x2F;zhuanlan.zhihu.">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-10-03T12:05:58.000Z">
<meta property="article:modified_time" content="2020-04-18T15:38:11.299Z">
<meta property="article:author" content="风梦七">
<meta property="article:tag" content="java">
<meta property="article:tag" content="spring">
<meta property="article:tag" content="springboot">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="笔记本" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xiaoyue26.github.io"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">笔记本</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">风梦七</a>
        </h2>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-springboot实战学习笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/03/springboot%E5%AE%9E%E6%88%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2017-10-03T12:05:58.000Z" itemprop="datePublished">2017-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/java/">java</a>►<a class="article-category-link" href="/categories/java/spring/">spring</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      springboot实战学习笔记
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h1 id="安装spring-cli"><a href="#安装spring-cli" class="headerlink" title="安装spring cli"></a>安装spring cli</h1><p>略</p>
<h1 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h1><ul>
<li>用网页创建:<a href="http://start.spring.io/" target="_blank" rel="noopener">http://start.spring.io/</a></li>
<li>用Intellij创建.<blockquote>
<p>如果是创建了gradle项目,一般需要加上插件:<br>apply plugin: ‘idea’<br>执行:<br>gradle cleanIdea idea<br>才能正常使用.(idea生成的项目默认使用eclipse的插件,多么讽刺)</p>
</blockquote>
</li>
</ul>
<h1 id="JPA相关"><a href="#JPA相关" class="headerlink" title="JPA相关:"></a>JPA相关:</h1><p><a href="https://zhuanlan.zhihu.com/p/25000309" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/25000309</a></p>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章:"></a>第二章:</h1><ul>
<li>依赖顺序:(可以与书写顺序相反,自顶向下或自底向上)<br>实体Book&lt;=仓库(&lt;Book,Long&gt;)</li>
</ul>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><ul>
<li><p>实体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Entity 领域对象</span><br><span class="line">@Id 主键</span><br><span class="line">@GeneratedValue(strategy&#x3D;GenerationType.AUTO) 自增id</span><br><span class="line">其他就是getter,setter了.</span><br></pre></td></tr></table></figure>
</li>
<li><p>repository</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">interface xxx extends JpaRepository&lt;Book, Long&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;@Controller 用于类</span><br><span class="line">&#x2F;&#x2F;@RequestMapping 用于类或方法</span><br><span class="line">&#x2F;&#x2F;@Autowired  可以对类成员变量、方法及构造函数进行标注，完成自动装配的工作。</span><br><span class="line">&#x2F;&#x2F; 最后返回视图名(String)</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.ui.Model;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"></span><br><span class="line">@Controller &#x2F;&#x2F; 注册ctrl到spring context中,成为一个bean.</span><br><span class="line">@RequestMapping(&quot;&#x2F;readingList&quot;) &#x2F;&#x2F; 匹配url. </span><br><span class="line">public class ReadingListController &#123;</span><br><span class="line"></span><br><span class="line">  private static final String reader &#x3D; &quot;craig&quot;;</span><br><span class="line">  </span><br><span class="line">	private ReadingListRepository readingListRepository;</span><br><span class="line"></span><br><span class="line">	@Autowired  &#x2F;&#x2F; 注入构造函数的输入参数</span><br><span class="line">	public ReadingListController(ReadingListRepository readingListRepository) &#123;</span><br><span class="line">		this.readingListRepository &#x3D; readingListRepository;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@RequestMapping(method&#x3D;RequestMethod.GET)&#x2F;&#x2F; 匹配GET</span><br><span class="line">	public String readersBooks(Model model) &#123;</span><br><span class="line">		</span><br><span class="line">		List&lt;Book&gt; readingList &#x3D; readingListRepository.findByReader(reader);</span><br><span class="line">		if (readingList !&#x3D; null) &#123;</span><br><span class="line">			model.addAttribute(&quot;books&quot;, readingList);</span><br><span class="line">		&#125;</span><br><span class="line">		return &quot;readingList&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@RequestMapping(method&#x3D;RequestMethod.POST)&#x2F;&#x2F; 匹配POST</span><br><span class="line">	public String addToReadingList(Book book) &#123;</span><br><span class="line">		book.setReader(reader);</span><br><span class="line">		readingListRepository.save(book);</span><br><span class="line">		return &quot;redirect:&#x2F;readingList&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="条件化注解"><a href="#条件化注解" class="headerlink" title="条件化注解"></a>条件化注解</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@ConditionalOnBean 配置了某个特定Bean</span><br><span class="line">@ConditionalOnMissingBean 没有配置特定的Bean</span><br><span class="line">@ConditionalOnClass Classpath里有指定的类</span><br><span class="line">@ConditionalOnMissingClass Classpath里缺少指定的类</span><br><span class="line">@ConditionalOnExpression </span><br><span class="line">&#x2F;&#x2F;给定的Spring Expression Language（SpEL）表达式计算结果为true</span><br><span class="line">@ConditionalOnJava Java的版本匹配特定值或者一个范围值</span><br><span class="line">@ConditionalOnJndi</span><br><span class="line">&#x2F;&#x2F;参数中给定的JNDI位置必须存在一个，如果没有给参数，则要有JNDI</span><br><span class="line">InitialContext</span><br><span class="line"></span><br><span class="line">@ConditionalOnProperty 指定的配置属性要有一个明确的值</span><br><span class="line">@ConditionalOnResource Classpath里有指定的资源</span><br><span class="line">@ConditionalOnWebApplication 这是一个Web应用程序</span><br><span class="line">@ConditionalOnNotWebApplication 这不是一个Web应用程序</span><br></pre></td></tr></table></figure>

<p>数据源相关spring源代码:// DataSourceAutoConfiguration</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">@ConditionalOnClass(&#123; DataSource.class, EmbeddedDatabaseType.class &#125;)&#x2F;&#x2F; classpath里必须有这两个类</span><br><span class="line">@EnableConfigurationProperties(DataSourceProperties.class)</span><br><span class="line">@Import(&#123; Registrar.class, DataSourcePoolMetadataProvidersConfiguration.class &#125;)</span><br><span class="line">public class DataSourceAutoConfiguration &#123;</span><br><span class="line">&#x2F;&#x2F; do something</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="springboot配置决策"><a href="#springboot配置决策" class="headerlink" title="springboot配置决策:"></a>springboot配置决策:</h2><blockquote>
<ol>
<li>ClassPath里有H2时,创建一个嵌入式的H2数据库Bean.<br>//类型是javax.sql.DataSource,JPA实现(Hibernate)需要.<br>//org.springframework.orm里放的是Hibernate3,4,5代码</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li>ClassPath里有Hibernate时,自动配置相关bean,包括:<br>Spring的实体管理相关,和JpaVendorAdaptor.</li>
</ol>
</blockquote>
<blockquote>
<ol start="3">
<li>ClassPath里有Spring Data JPA时,自动配置为:<br>根据仓库接口创建仓库实现. (Repository相关代码)</li>
</ol>
</blockquote>
<blockquote>
<ol start="4">
<li>ClassPath里有Thymeleaf时,将其配置为Spring MVC的视图,包括模板解析器,模板引擎及视图解析器.<br>视图会解析相对于classPath根目录的/templates目录里的模板. </li>
</ol>
</blockquote>
<blockquote>
<ol start="5">
<li>ClassPath里有Spring MVC时(web starter里有), 配置Spring DispatcherServlet并启用Spring MVC. </li>
</ol>
</blockquote>
<blockquote>
<ol start="6">
<li>发现是SpringMVC web项目时,注册一个资源处理器,提供:<br>/static<br>/public<br>/resources<br>/META-INF/resources<br>中静态内容.</li>
</ol>
</blockquote>
<blockquote>
<ol start="7">
<li>ClassPath里有Tomcat时(Web starter里有),启动嵌入式Tomcat. </li>
</ol>
</blockquote>
<h1 id="第三章-自定义配置"><a href="#第三章-自定义配置" class="headerlink" title="第三章 自定义配置"></a>第三章 自定义配置</h1><p>主要讲如何覆盖第二章中的默认配置.</p>
<ol>
<li>覆盖自动配置的bean</li>
<li>用外置属性进行配置</li>
<li>自定义错误页</li>
</ol>
<ul>
<li>bean覆盖的原理:<br>springboot先加载应用级配置,然后使用@ConditionalOnMissingBean加载自动配置.<br>因此覆盖的第一种办法是重写一个完整的bean,比较繁琐.</li>
</ul>
<ul>
<li>用外置属性<br>微调一些属性. </li>
</ul>
<ol>
<li>运行时命令行参数中指定:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar readinglist-0.0.1-SNAPSHOT.jar --spring.main.show-banner&#x3D;false</span><br></pre></td></tr></table></figure></li>
<li><code>application.properties</code>中指定:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.main.show-banner&#x3D;false</span><br></pre></td></tr></table></figure></li>
<li><code>为application.yml</code>中指定:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"> main:</span><br><span class="line"> show-banner: false</span><br></pre></td></tr></table></figure></li>
<li>环境变量中指定:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export spring_main_show_banner&#x3D;false</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>优先级:</p>
<ol>
<li>命令行 – 最优先</li>
<li>java:comp/env中的JNDI属性.</li>
<li>JVM系统属性</li>
<li>操作系统环境变量</li>
<li>随机生成的带random.*前缀的属性</li>
<li>应用程序外的application.properties或yml文件</li>
<li>应用程序内的application.properties或yml文件</li>
<li>通过@PropertySource标注的属性源</li>
<li>默认属性</li>
</ol>
<p>位置优先级:<br>//application.properties或application.yml文件</p>
<ol>
<li>外置 运行目录的/config目录</li>
<li>外置 运行目录</li>
<li>内置 config包内</li>
<li>内置 classPath根目录. </li>
</ol>
<p>##可以调整的属性例子:</p>
<ol>
<li><p>禁用模板缓存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"> thymeleaf:</span><br><span class="line"> cache: false</span><br></pre></td></tr></table></figure>
<p>同样适用于:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.freemarker.cache</span><br><span class="line">spring.groovy.template.cache</span><br><span class="line">spring.velocity.cache</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置嵌入式服务器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port&#x3D;8000</span><br></pre></td></tr></table></figure>
<p>配置https服务的key:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -keystore mykeys.jks -genkey -alias tomcat -keyalg RSA</span><br></pre></td></tr></table></figure>
<p>yml:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line"> port: 8443</span><br><span class="line"> ssl:</span><br><span class="line"> key-store: file:&#x2F;&#x2F;&#x2F;path&#x2F;to&#x2F;mykeys.jks </span><br><span class="line"> key-store-password: letmein</span><br><span class="line"> key-password: letmein</span><br></pre></td></tr></table></figure>
</li>
<li><p>日志配置<br>使用Log4j://默认使用logback</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gradle:</span><br><span class="line">configurations &#123;</span><br><span class="line"> all*.exclude group:&#39;org.springframework.boot&#39;,</span><br><span class="line"> module:&#39;spring-boot-starter-logging&#39;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">compile(&quot;org.springframework.boot:spring-boot-starter-log4j&quot;) </span><br><span class="line">&#x2F;&#x2F;log4j2</span><br><span class="line">compile(&quot;org.springframework.boot:spring-boot-starter-log4j2&quot;)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>单独的日志配置文件:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">logging:</span><br><span class="line"> config:</span><br><span class="line"> classpath:logging-config.xml</span><br></pre></td></tr></table></figure>
<p>日志级别:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logging:</span><br><span class="line"> path: &#x2F;var&#x2F;logs&#x2F;</span><br><span class="line"> file: BookWorm.log</span><br><span class="line"> level:</span><br><span class="line"> root: WARN</span><br><span class="line"> org:</span><br><span class="line"> springframework:</span><br><span class="line"> security: DEBUG</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>配置数据源<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line"> datasource:</span><br><span class="line"> url: jdbc:mysql:&#x2F;&#x2F;localhost&#x2F;readinglist</span><br><span class="line"> username: dbuser</span><br><span class="line"> password: dbpass</span><br></pre></td></tr></table></figure>
数据库连接池寻找顺序://ClassPath</li>
<li>tomcat</li>
<li>HikariCP</li>
<li>Commons DBCP</li>
<li>Commons DBCP2</li>
</ol>
<p>打开debug看日志的话,<code>dataSourceInitializer</code>数据源初始化的时候会自动执行resources目录下的<code>data.sql</code>文件.</p>
<blockquote>
<p>@ManyToOne等数据库相关注解:<br><a href="https://www.cnblogs.com/yxjdragon/p/6008603.html" target="_blank" rel="noopener">https://www.cnblogs.com/yxjdragon/p/6008603.html</a></p>
</blockquote>
<ol>
<li>一个A对应多个B:<br>方法1:A里设置主键;B里使用@ManyToOne设置关联;<br>方法2:A里使用@OneToMany,Set<User>;B里设置主键. </li>
</ol>
<h2 id="第三种配置方式-应用程序Bean的配置外置"><a href="#第三种配置方式-应用程序Bean的配置外置" class="headerlink" title="第三种配置方式: 应用程序Bean的配置外置"></a>第三种配置方式: 应用程序Bean的配置外置</h2><p>详见:<br><a href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-profiles" target="_blank" rel="noopener">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-profiles</a></p>
<p>真的是博大精深,千变万化.<br>代码示例中的注入过程:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">网页模板中$&#123;amazonID&#125;</span><br><span class="line">&lt;&#x3D; model.addAttribute(&quot;amazonID&quot;, amazonConfig.getAssociateId());</span><br><span class="line">&lt;&#x3D; amazonConfig是AmazonProperties的一个对象:</span><br><span class="line">AmazonProperties:</span><br><span class="line">@Component</span><br><span class="line">@ConfigurationProperties(&quot;amazon&quot;)</span><br><span class="line">public class AmazonProperties &#123;</span><br><span class="line"></span><br><span class="line">  private String associateId;</span><br><span class="line">  </span><br><span class="line">  public void setAssociateId(String associateId) &#123;</span><br><span class="line">    this.associateId &#x3D; associateId;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  public String getAssociateId() &#123;</span><br><span class="line">    return associateId;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x3D; Controller的构造函数中注入:</span><br><span class="line">@ConfigurationProperties(&quot;amazon&quot;)</span><br><span class="line">public class ReadingListController &#123;</span><br><span class="line">@Autowired&#x2F;&#x2F; 自动注入方法的参数</span><br><span class="line">	public ReadingListController(ReadingListRepository readingListRepository,</span><br><span class="line">								 AmazonProperties amazonConfig) &#123;</span><br><span class="line">		this.readingListRepository &#x3D; readingListRepository;</span><br><span class="line">		this.amazonConfig &#x3D; amazonConfig;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&#x3D; 最根源: application.yml文件:</span><br><span class="line">amazon:</span><br><span class="line">  associate_id: habuma-20</span><br></pre></td></tr></table></figure>



<h1 id="第四章-单元测试"><a href="#第四章-单元测试" class="headerlink" title="第四章: 单元测试"></a>第四章: 单元测试</h1><ol>
<li>用Mock进行测试</li>
<li>用Mock,带着登录用户信息</li>
<li>用模拟器测试(Selenium)</li>
<li>用模拟器测试(Selenium),带着cookie(这个没写)</li>
</ol>
<h1 id="第五章-Groovy与Spring-Boot-CLI"><a href="#第五章-Groovy与Spring-Boot-CLI" class="headerlink" title="第五章: Groovy与Spring Boot CLI"></a>第五章: Groovy与Spring Boot CLI</h1><p>似乎是凑字数的一章. 大致跑了一下代码,浏览了一下.</p>
<h1 id="第六章"><a href="#第六章" class="headerlink" title="第六章:"></a>第六章:</h1><p>感觉是私货,大致扫了一下内容,代码都没跑.</p>
<p>先配数据源:<br><a href="http://www.jianshu.com/p/34730e595a8c" target="_blank" rel="noopener">http://www.jianshu.com/p/34730e595a8c</a></p>
<h1 id="注解笔记"><a href="#注解笔记" class="headerlink" title="注解笔记"></a>注解笔记</h1><p>阅读过程遇到的注解越来越多,有必要总结一下:</p>
<h2 id="1-声明Bean的注解-其实可以都用-Component"><a href="#1-声明Bean的注解-其实可以都用-Component" class="headerlink" title="1. 声明Bean的注解: 其实可以都用@Component"></a>1. 声明Bean的注解: 其实可以都用@Component</h2><ul>
<li><code>@Service</code>用于标注业务层组件</li>
<li><code>@Controller</code>用于标注控制层组件（如struts中的action）</li>
<li><code>@Repository</code>用于标注数据访问组件，即DAO组件</li>
<li><code>@Component</code>泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。</li>
<li><code>@Bean</code>声明一个bean,还可以定义的属性:name,initMethod,destroyMethod,autowire(装配策略:<code>Autowire.BY_NAME</code>，<code>Autowire.BY_TYPE</code>，<code>Autowire.NO</code>)</li>
<li><code>@Primary</code>, 修饰这个Bean应优先被使用.// @Qualifier则是在使用的时候显示指定使用哪个.</li>
</ul>
<p>还有一个有用的注解:</p>
<ul>
<li><code>@Order</code>: 声明装配的顺序.经过测试,加载的顺序还是字母序,不受影响. 如果装配到List<IRank>容器里,装配的顺序由@Order决定.以此类推,同级别的切面实现,执行顺序也是按@Order. </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 使用样例:</span><br><span class="line">@Order(100)</span><br><span class="line">public abstract class WebSecurityConfigurerAdapter implements</span><br><span class="line">&#x2F;&#x2F; 源码:</span><br><span class="line">public @interface Order &#123;</span><br><span class="line">    int value() default 2147483647;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>默认Bean的名字:<br>    &gt; 类名(头字母小写)</p>
<p>更改Bean的名字:<br>    &gt; @Service(“beanName”)</p>
<p>默认Bean是单例,要改变:<br>    &gt; @Scope(“prototype”)</p>
<p><code>bean</code>的生命周期   </p>
<blockquote>
<ol>
<li>singleton: 默认是单例,与容器共存亡,基本就是始终存活;</li>
<li>prototype: 每次都是新的,与单例相反,调用者自己负责销毁;</li>
</ol>
<p>– 后三种是新增的,专用于web应用的<br>3. request: 每个HTTP请求一个,是prototype的一种扩展;<br>4. session: 每个Session一个,但咱公司一般不用session,用cookie;<br>5. global session: 基于porlet的web应用程序中才有意义.</p>
</blockquote>
<p>增加初始化方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@PostConstruct public void init() &#123; &#125;</span><br></pre></td></tr></table></figure>
<p>增加析构方法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@PreDestroy public void destory() &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-使用Bean的注解"><a href="#2-使用Bean的注解" class="headerlink" title="2. 使用Bean的注解:"></a>2. 使用Bean的注解:</h2><ul>
<li><code>@Autowired</code> 不需要写getter和setter</li>
<li><code>@Qualifier</code> 如果同一个接口有多个实现类的话,需要指定具体注入哪一个:<blockquote>
<p>@Qualifier(“chinese”)       </p>
</blockquote>
</li>
<li><code>@Resource</code> 约等于<code>@Autowired</code>,区别是默认按name进行注入.也可以选择类型.</li>
</ul>
<p><code>@Autowired</code>:</p>
<blockquote>
<p>构造函数注入和字段注入的区别:(Spring场景下)</p>
</blockquote>
<ol>
<li>构造函数注入时,spring能检测循环依赖并报错;而字段注入的时候,spring检测出来以后会想办法解决,不会报错.</li>
<li>构造函数注入时,能控制注入顺序.</li>
<li>字段注入时,spring能按需注入,写起来简单;</li>
</ol>
<ul>
<li>字段注入的缺点:</li>
</ul>
<ol>
<li>不能创建不可变对象;</li>
<li>与DI容器紧耦合,不能在类外使用;</li>
<li>除了反射,类不能被实例化(例如在单元测试中).//只能进行集成测试</li>
<li>从外部(接口或构造函数)无法看出依赖,依赖情况隐藏在实现中.</li>
<li>如果有循环依赖,并不会报错,隐藏了可能的错误.<br>// 如果一个类依赖太多,很可能是违反了设计原则.</li>
</ol>
<p>原则:</p>
<ol>
<li>必须项\不可变项: 使用构造函数注入;</li>
<li>可选项\可变项: 使用字段注入;</li>
<li>大部分情况下避免字段注入. 尽量使用构造函数注入.</li>
</ol>
<h2 id="3-配置相关的注解"><a href="#3-配置相关的注解" class="headerlink" title="3.配置相关的注解:"></a>3.配置相关的注解:</h2><ul>
<li><p><code>@EnableAutoConfiguration</code></p>
<blockquote>
<p>启动自动配置,就是根据classpath中的jar,自动配置. </p>
</blockquote>
</li>
<li><p><code>@SpringBootConfiguration</code></p>
<blockquote>
<p>继承自<code>@Configuration</code>, 标记当前类为配置类.<br>实例代码:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">@EnableAutoConfiguration</span><br><span class="line">@ComponentScan</span><br><span class="line">public class SecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    private ReaderRepository readerRepository;</span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">        http</span><br><span class="line">                .authorizeRequests()</span><br><span class="line">                .antMatchers(&quot;&#x2F;&quot;).access(&quot;hasRole(&#39;READER&#39;)&quot;)</span><br><span class="line">                .antMatchers(&quot;&#x2F;**&quot;).permitAll()</span><br><span class="line">                .and()</span><br><span class="line">                .formLogin()</span><br><span class="line">                .loginPage(&quot;&#x2F;login&quot;)</span><br><span class="line">                .failureUrl(&quot;&#x2F;login?error&#x3D;true&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(</span><br><span class="line">            AuthenticationManagerBuilder auth) throws Exception &#123;</span><br><span class="line">        auth.userDetailsService(userDetailsService());</span><br><span class="line">    &#125;</span><br><span class="line">    @Bean</span><br><span class="line">    public UserDetailsService userDetailsService() &#123;</span><br><span class="line">        return new UserDetailsService() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public UserDetails loadUserByUsername(String username)</span><br><span class="line">                    throws UsernameNotFoundException &#123;</span><br><span class="line">                UserDetails userDetails &#x3D; readerRepository.findOne(username);</span><br><span class="line">                if (userDetails !&#x3D; null) &#123;</span><br><span class="line">                    return userDetails;</span><br><span class="line">                &#125;</span><br><span class="line">                throw new UsernameNotFoundException(&quot;User &#39;&quot; + username + &quot;&#39; not found.&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Spring</code>在解析到这种类时，将识别出标注<code>@Bean</code>的所有方法执行，<br>并将方法的返回值 (UserDetailsService)注册到IoC容器中。<br>默认情况下，Bean 的名字为方法名。</p>
</li>
<li><p><code>@ComponentScan</code></p>
<blockquote>
<p>扫描当前包及其子包下声明为Bean的类.(包括@Configure,@Contrller等等).<br>纳入Spring容器.<br>可以通过<code>@SpringBootApplication(scanBasePackages = &quot;com.xxx.yyy&quot;)</code>,更改扫描的范围.//子包相关:default包并不是其他包的父包.</p>
</blockquote>
</li>
</ul>
<h2 id="4-复合注解"><a href="#4-复合注解" class="headerlink" title="4.复合注解:"></a>4.复合注解:</h2><ul>
<li><p>@SpringBootApplication 包含:</p>
<blockquote>
<p>@SpringBootConfiguration<br>@EnableAutoConfiguration<br>@ComponentScan 等</p>
</blockquote>
</li>
<li><p>网上教材:<br><a href="https://doc.yonyoucloud.com/doc/Spring-Boot-Reference-Guide/IX.%20%E2%80%98How-to%E2%80%99%20guides/71.3.%20Enable%20HTTPS%20when%20running%20behind%20a%20proxy%20server.html" target="_blank" rel="noopener">https://doc.yonyoucloud.com/doc/Spring-Boot-Reference-Guide/IX.%20%E2%80%98How-to%E2%80%99%20guides/71.3.%20Enable%20HTTPS%20when%20running%20behind%20a%20proxy%20server.html</a></p>
</li>
</ul>
<h1 id="第七章-深入Actuator"><a href="#第七章-深入Actuator" class="headerlink" title="第七章 深入Actuator"></a>第七章 深入Actuator</h1><ul>
<li>Actuator Web端点</li>
<li>调整Actuator</li>
<li>通过shell连入运行中的应用程序</li>
<li>保护Actuator </li>
</ul>
<h2 id="7-1-Actuator的Web端点"><a href="#7-1-Actuator的Web端点" class="headerlink" title="7.1 Actuator的Web端点"></a>7.1 Actuator的Web端点</h2><p>HTTP方法 路径  描述</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;autoconfig 自动配置报告.记录各自动配置条件通过与否.</span><br><span class="line">GET &#x2F;configprops 描述配置属性(含默认值)如何注入Bean</span><br><span class="line">GET &#x2F;beans   描述上下文中所有Bean及关系.</span><br><span class="line">GET &#x2F;dump    获取线程活动的快照</span><br><span class="line">GET &#x2F;env     获取全部环境属性</span><br><span class="line">GET &#x2F;env&#x2F;&#123;name&#125; 根据名称获取特定的环境属性</span><br><span class="line">GET &#x2F;healthy    报告app的健康指标(由实现类提供)</span><br><span class="line">GET &#x2F;info       获取app的定制信息(由info开头的属性提供)</span><br><span class="line">GET &#x2F;mappings   描述全部的URI路径及其控制器(含Actuator端点)的映射关系</span><br><span class="line">GET &#x2F;matrics    报告各种应用程序度量信息,比如内存用量和HTTP请求计数</span><br><span class="line">GET &#x2F;trace      提供基本的HTTP请求跟踪信息(时间戳,HTTP头)</span><br><span class="line">POST &#x2F;shutdown  关闭app,要求endpoints.shutdown.enabled设置为true</span><br></pre></td></tr></table></figure>


<h2 id="7-2-查看配置明细"><a href="#7-2-查看配置明细" class="headerlink" title="7.2 查看配置明细"></a>7.2 查看配置明细</h2><blockquote>
<p>知道SpringBoot具体怎么装配的组件.</p>
</blockquote>
<p>配置yml :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">endpoints.sensitive: true</span><br><span class="line">management.context-path: &#x2F;admin</span><br><span class="line">management.security.enabled: true</span><br></pre></td></tr></table></figure>

<h3 id="beans-可读"><a href="#beans-可读" class="headerlink" title="/beans 可读"></a>/beans 可读</h3><p>用户权限上增加角色<code>new SimpleGrantedAuthority(&quot;ROLE_ACTUATOR&quot;)</code>;<br>然后访问:<br><a href="http://localhost:8000/admin/beans" target="_blank" rel="noopener">http://localhost:8000/admin/beans</a><br>获取所有Beans的信息.包括依赖,以及具体是使用JDK动态代理的还是CGLIB代理的.</p>
<blockquote>
<p>基于JDK动态代理 ，可以将@Transactional放置在接口和具体类上。<br>基于CGLIB类代理，只能将@Transactional放置在具体类上。</p>
</blockquote>
<h3 id="autoconfig-难读"><a href="#autoconfig-难读" class="headerlink" title="/autoconfig 难读"></a>/autoconfig 难读</h3><ul>
<li>条件化配置(自动配置)信息,<code>positiveMatches</code>以及<code>negativeMatches</code>,比较难看懂,真正有需要的时候进去搜索即可:<br><a href="http://localhost:8000/admin/autoconfig" target="_blank" rel="noopener">http://localhost:8000/admin/autoconfig</a></li>
</ul>
<h3 id="env-可读-易读"><a href="#env-可读-易读" class="headerlink" title="/env 可读,易读"></a>/env 可读,易读</h3><ul>
<li>环境变量信息<blockquote>
<p>包括启用的是哪个profiles,用的哪个log配置,各种运行时变量.<br>其中数据库连接是明文,数据库密码是星号代替.因此密码不能写到数据库连接里.</p>
</blockquote>
</li>
</ul>
<h3 id="configprops-可读"><a href="#configprops-可读" class="headerlink" title="/configprops 可读"></a>/configprops 可读</h3><ul>
<li>配置属性报告<br>可以看到有哪些属性被注入了Bean,可以从中学到有哪些属性可以在yml中设置.</li>
</ul>
<h3 id="mappings-可读"><a href="#mappings-可读" class="headerlink" title="/mappings 可读"></a>/mappings 可读</h3><ul>
<li>端点和控制器的映射.<br>可以看到所有url都映射到了哪个controller,可以从中学到有哪些url可以使用.</li>
</ul>
<h3 id="metrics-可读"><a href="#metrics-可读" class="headerlink" title="/metrics 可读"></a>/metrics 可读</h3><ul>
<li>运行时统计.<br>包括线程,内存,数据库连接活跃等信息.</li>
</ul>
<h3 id="trace-可读"><a href="#trace-可读" class="headerlink" title="/trace 可读"></a>/trace 可读</h3><ul>
<li>报告所有Web请求的详细信息，包括请求方法、路径、时间戳以及请求和响应的头信息。实际能显示最近100个请求的信息,似乎对于测试应用有用,线上应用请求量一大,100条里应该就不会有想要的日志了.</li>
</ul>
<h3 id="dump-难读"><a href="#dump-难读" class="headerlink" title="/dump 难读"></a>/dump 难读</h3><ul>
<li>当前活跃线程快照.<br>太长了.不过每个线程的信息很短.</li>
</ul>
<h3 id="health-可读"><a href="#health-可读" class="headerlink" title="/health 可读"></a>/health 可读</h3><ul>
<li>当前程序,磁盘,数据库是否活着. </li>
</ul>
<h3 id="shutdown-POST"><a href="#shutdown-POST" class="headerlink" title="/shutdown POST"></a>/shutdown POST</h3><p>发送关闭命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http:&#x2F;&#x2F;localhost:8000&#x2F;admin&#x2F;shutdown</span><br></pre></td></tr></table></figure>
<p>如果要身份验证,命令就比较不好搞了,需要python脚本或者别的代码辅助.</p>
<h3 id="info-可读"><a href="#info-可读" class="headerlink" title="/info 可读"></a>/info 可读</h3><p>显示在yml里配的info属性的值.比如联系方式.</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>接下来书里介绍了用shell完成和REST api一样的功能,感觉有点难用.</p>
<h2 id="JMX监控"><a href="#JMX监控" class="headerlink" title="JMX监控"></a>JMX监控</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jconsole [进程号]</span><br><span class="line">&#x2F;&#x2F; eg. jconsole 61611</span><br></pre></td></tr></table></figure>
<p>除了进程\线程运行的信息,在MBean面板还有<code>org.springframework.boot</code>目录,下面有REST api中的属性,可以通过data属性的值得到相同的值.<br>值得注意的是,与REST api不同的是,一旦启用了shutdown,即使不登录用户,也可以通过Jconsole关闭app. </p>
<h2 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h2><p>接下来介绍了如何自定义端点url,以及加入自定义内容.<br>还可以把/trace接口的内容存到mongodb.<br>细节略过不提.</p>
<h2 id="第八章-部署"><a href="#第八章-部署" class="headerlink" title="第八章 部署"></a>第八章 部署</h2><p>讲了下如何部署的细节,网上有别的教程.各种对照着做才行.</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>包括开发工具,远程调试. 如果有需要可以看看.<br>剩下的是起步依赖的一些详细信息.</p>
<p>这本书还蛮短的.</p>
<h1 id="CommandLineRunner接口"><a href="#CommandLineRunner接口" class="headerlink" title="CommandLineRunner接口"></a>CommandLineRunner接口</h1><p>CommandLineRunner、ApplicationRunner 接口是在容器启动成功后的最后一步回调（类似开机自启动）。<br>可以在集成测试的时候使用.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xiaoyue26.github.io/2017/10/03/springboot%E5%AE%9E%E6%88%98%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="ck96cxplz0055maamguh1clvu" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li></ul>

    </footer>
  </div>
  
    
 
<script src="/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
    <a href="/2017/10/24/spring%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          spring实战笔记
        
      </div>
    </a>
  
  
    <a href="/2017/10/01/mysql-sqoop-hive%E5%88%86%E9%9A%94%E7%AC%A6%E6%80%BB%E7%BB%93/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">mysql,sqoop,hive分隔符总结</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
           <div id="gitment_comments"></div>
    
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    

  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#安装spring-cli"><span class="toc-number">1.</span> <span class="toc-text">安装spring cli</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#创建项目"><span class="toc-number">2.</span> <span class="toc-text">创建项目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JPA相关"><span class="toc-number">3.</span> <span class="toc-text">JPA相关:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第二章"><span class="toc-number">4.</span> <span class="toc-text">第二章:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#注解"><span class="toc-number">4.1.</span> <span class="toc-text">注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#条件化注解"><span class="toc-number">4.2.</span> <span class="toc-text">条件化注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#springboot配置决策"><span class="toc-number">4.3.</span> <span class="toc-text">springboot配置决策:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第三章-自定义配置"><span class="toc-number">5.</span> <span class="toc-text">第三章 自定义配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#第三种配置方式-应用程序Bean的配置外置"><span class="toc-number">5.1.</span> <span class="toc-text">第三种配置方式: 应用程序Bean的配置外置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第四章-单元测试"><span class="toc-number">6.</span> <span class="toc-text">第四章: 单元测试</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第五章-Groovy与Spring-Boot-CLI"><span class="toc-number">7.</span> <span class="toc-text">第五章: Groovy与Spring Boot CLI</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第六章"><span class="toc-number">8.</span> <span class="toc-text">第六章:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#注解笔记"><span class="toc-number">9.</span> <span class="toc-text">注解笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-声明Bean的注解-其实可以都用-Component"><span class="toc-number">9.1.</span> <span class="toc-text">1. 声明Bean的注解: 其实可以都用@Component</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-使用Bean的注解"><span class="toc-number">9.2.</span> <span class="toc-text">2. 使用Bean的注解:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-配置相关的注解"><span class="toc-number">9.3.</span> <span class="toc-text">3.配置相关的注解:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-复合注解"><span class="toc-number">9.4.</span> <span class="toc-text">4.复合注解:</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#第七章-深入Actuator"><span class="toc-number">10.</span> <span class="toc-text">第七章 深入Actuator</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-Actuator的Web端点"><span class="toc-number">10.1.</span> <span class="toc-text">7.1 Actuator的Web端点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-查看配置明细"><span class="toc-number">10.2.</span> <span class="toc-text">7.2 查看配置明细</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#beans-可读"><span class="toc-number">10.2.1.</span> <span class="toc-text">&#x2F;beans 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#autoconfig-难读"><span class="toc-number">10.2.2.</span> <span class="toc-text">&#x2F;autoconfig 难读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#env-可读-易读"><span class="toc-number">10.2.3.</span> <span class="toc-text">&#x2F;env 可读,易读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configprops-可读"><span class="toc-number">10.2.4.</span> <span class="toc-text">&#x2F;configprops 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mappings-可读"><span class="toc-number">10.2.5.</span> <span class="toc-text">&#x2F;mappings 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics-可读"><span class="toc-number">10.2.6.</span> <span class="toc-text">&#x2F;metrics 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trace-可读"><span class="toc-number">10.2.7.</span> <span class="toc-text">&#x2F;trace 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump-难读"><span class="toc-number">10.2.8.</span> <span class="toc-text">&#x2F;dump 难读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#health-可读"><span class="toc-number">10.2.9.</span> <span class="toc-text">&#x2F;health 可读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shutdown-POST"><span class="toc-number">10.2.10.</span> <span class="toc-text">&#x2F;shutdown POST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#info-可读"><span class="toc-number">10.2.11.</span> <span class="toc-text">&#x2F;info 可读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他"><span class="toc-number">10.3.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JMX监控"><span class="toc-number">10.4.</span> <span class="toc-text">JMX监控</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他-1"><span class="toc-number">10.5.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第八章-部署"><span class="toc-number">10.6.</span> <span class="toc-text">第八章 部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-number">10.7.</span> <span class="toc-text">附录</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CommandLineRunner接口"><span class="toc-number">11.</span> <span class="toc-text">CommandLineRunner接口</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2022 风梦七&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;296671657@qq.com
    </div>
  </div>
</footer>
 
<script src="/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

  <link rel="stylesheet" href="https://jjeejj.github.io/css/gitment.css">
  <script src="https://www.wenjunjiang.win/js/gitment.js"></script>
  <script>
  var gitment = new Gitment({
    // id: '页面 ID', // 可选。默认为 location.href
    owner: 'xiaoyue26',
    repo: 'xiaoyue26.github.io',
    oauth: {
    client_id: 'cfe53b938f0d4c782371',
    client_secret: 'f96e68ae1103e7500c106aa3656a8bb31fe0ee99',
    }
  })
  gitment.render(document.getElementById("gitment_comments"))
</script>


<!-- author:forvoid end -->

<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 
<script src="/js/is.js"></script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/elevator.js"></script>

  </div>
</body>
</html>